<?php//подключаемся к базеinclude_once 'm/startup.php';// список всех статейfunction articles_all(){	// запрос	$sql = 'SELECT `id`,`date`, `name`, SUBSTRING(`content`, 1, 500) AS `content` FROM `lesson2` ORDER BY `date` DESC';	//Выполняем запрос в БД	$result = mysqli_query(getDbConnect(), $sql);	//Проверяем есть ли записи в БД	if (!$result) {		die(mysqli_error(getDbConnect()));	}	// если есть, то извлекаем из БД данные	$rows = mysqli_num_rows($result);	$articles = array();	if (!$rows) {		return $articles;	}	//Формируем массив из полученных данных	while ($row = mysqli_fetch_assoc($result)) {		$articles[] = $row;	}	return array($articles);}// получить конкретную статьюfunction articles_get($id_article){	// Подготовка	$id_article=(int)$id_article;	//Запрос	$sql="SELECT * FROM `Lesson2` WHERE `id`='$id_article'";	//Выполняем запрос в БД	$request=mysqli_query(getDbConnect(),$sql);	//Формируем массив из полученных данных	$article=array();	While ($row=mysqli_fetch_assoc($request)) {		$article[]=$row;	}	return array($article);}// добавить статьюfunction articles_new($name, $date, $content){	// Подготовка	$name = trim($name);	$content = trim($content);	//Безопасность данных от иньекций	$name = sql_escape($name);	$content = sql_escape($content);	// Проверка	if ($name == '') {		return false;	}	// Запрос	$sql = "INSERT INTO `lesson2` (`date`, `name`,`content`) VALUES ('$date','%s', '%s')";	//выполняем запрос	$query = sprintf($sql, sql_escape($name), sql_escape($content));	$result = mysqli_query(getDbConnect(), $query);	if (!$result) {		die(mysqli_error(getDbConnect()));	}	return true;}// изменить статьюfunction articles_edit($id_article, $name, $content){	//Безопасность данных от иньекций	$id_article=(int)($id_article);	$name = sql_escape($name);	$content = sql_escape($content);	//Запрос в бд	$request="UPDATE `lesson2` SET `name`='$name', `content`='$content' WHERE `id`='$id_article'";	//Выполняем запрос	mysqli_query(getDbConnect(),$request);}// удаление статьиfunction articles_delete($id_article){	//Безопасность данных от иньекций	$id_article=(int)($id_article);	//Запрос	$sql="DELETE FROM `lesson2` WHERE `id` = $id_article";	//Выполняем запрос	mysqli_query(getDbConnect(),$sql);}// Выборка всех статей в виде превьюfunction articles_getIntro($sub, $page, $count){	$sub = (int)$sub;       // кол-во символов которое требуется вернуть	$page = (int)$page;     // номер страницы	// Постраничная навигация	$page = !empty($page) ? $page : 1;	$offset = ($page-1) * $count;	$sql = "SELECT `id`, `name`, `date`, SUBSTRING(`content`, 1, '$sub') AS `content` FROM `lesson2` ORDER BY `id` DESC LIMIT $offset, $count";	return sql_select($sql);}// Подключение шаблона.function template($fileName, $vars = array()){	// Устанавливаем переменные из массива в шаблон	extract($vars);	// Генерация HTML в строку.	ob_start();	include $fileName;	return ob_get_clean();}// Функция для изменения цвета нажатой ссылки. Принимает два параметра для сравнения и название класса(css),// при совпадении выводит класс// а вообще, можно использовать не только для цвета)function click($i, $num, $color){	$num = isset($num) ? $num : 0;	if($i == $num) {		echo 'class="' . $color . '"';	}}// Функция редиректаfunction redirect($url){	header("Location: $url");	exit;}// возвращает кол-во статей в БДfunction articles_count(){	$sql = "SELECT COUNT(*) AS `count` FROM `lesson2`";	// Выполнение запроса	$result = mysqli_query(getDbConnect(), $sql);	if (!$result) {		die(mysqli_error(getDbConnect()));	}	// извлекаем из БД данные	$array = array();	while($row = mysqli_fetch_assoc($result))		$array[] = $row;	return $array['0']['count'];}function sql_select($sql){	// Выполнение запроса	$result = mysqli_query(getDbConnect(), $sql);	if (!$result) {		die(mysqli_error(getDbConnect()));	}	// извлекаем из БД данные	$array = array();	while($row = mysqli_fetch_assoc($result))		$array[] = $row;	return array($array);}